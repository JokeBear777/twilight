<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>책 추천</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo&family=Noto+Serif+KR&display=swap"
          rel="stylesheet">

    <style>
        .gradient-custom {
            background: linear-gradient(to right, rgba(106, 17, 203, 1), rgba(37, 117, 252, 1))
        }

        .btn.active {
            background-color: #ffc107 !important;
            color: black !important;
            border-color: #ffc107 !important;
        }

        /* 기본적으로 숨겨진 스크롤바 */
        .card-body::-webkit-scrollbar {
            width: 6px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* 스크롤바 트랙 */
        .card-body::-webkit-scrollbar-track {
            background: transparent;
        }

        /* 스크롤바 손잡이 */
        .card-body::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        /* 스크롤 중일 때만 스크롤바 보이게 */
        .card-body.scrolling::-webkit-scrollbar {
            opacity: 1;
        }


        .bg-ivory {
            background-color: #fffff0;
        }


        h1,
        h2,
        h3,
        h4 {
            font-family: 'Nanum Myeongjo', serif;
        }

        body {
            font-family: 'Dongle', sans-serif;
        }
    </style>
</head>

<body class="gradient-custom">
<section class="d-flex justify-content-center align-items-center" style="min-height:100vh;">
    <!-- 카드 전체 -->
    <div class="card bg-dark d-flex flex-column" style="border-radius:1rem; width:375px; height:650px;">

        <!-- 스크롤 가능한 콘텐츠 영역 -->
        <div class="card-body p-3 d-flex flex-column justify-content-center align-items-center"
             style="overflow-y:auto;">
            <form th:action="@{/book/recommendation}" method="POST" class="text-center w-100">
                <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}" />

                <!-- 텍스트 -->
                <h2 class="text-white mb-4" style="font-size:1.8rem; font-weight:600;">
                    책을 고르고 있어요<br>잠시만 기다려주세요
                </h2>

                <!-- 스피너 -->
                <div class="spinner-border text-light" role="status" style="width:8rem; height:8rem;">
                    <span class="visually-hidden"></span>
                </div>
            </form>
        </div>
        <!-- ③ 고정 footer(nav)  ------------------>
        <nav class="bg-dark border-top py-2">
            <div class="d-flex justify-content-around text-white">
                <button class="btn btn-dark d-flex flex-column align-items-center">
                    <i class="fas fa-home"></i><small>홈</small>
                </button>
                <button class="btn btn-dark d-flex flex-column align-items-center">
                    <i class="fas fa-book"></i><small>내 서재</small>
                </button>
                <button class="btn btn-dark d-flex flex-column align-items-center">
                    <i class="fas fa-search"></i><small>책 추천</small>
                </button>
                <button class="btn btn-dark d-flex flex-column align-items-center">
                    <i class="fas fa-comments"></i><small>게시판</small>
                </button>
                <button class="btn btn-dark d-flex flex-column align-items-center">
                    <i class="fas fa-user"></i><small>내 정보</small>
                </button>
            </div>
        </nav>
    </div>
</section>

<script>
    const intervalId = setInterval(() => {
        fetch('/recommendation/complete')
            .then(response => {
                if (response.status === 200) {
                    // 결과가 있으면 페이지 이동
                    window.location.href = '/recommendation/complete';
                    clearInterval(intervalId); // 더 이상 요청 안 보냄
                }
            })
            .catch(err => console.error('Polling error:', err));
    }, 2000); // 2000ms = 2초
</script>
</body>

</html>